## 예측가능한 API 디자인하기

- 익숙하지 않은 물건을 보아도 사용법을 아는 것 처럼 API도 본능적으로 사용할 수 있으면 좋을것이야.



### 일관성 유지하기

- 예전에 삼각형 모양이 카세트에서 재생 버튼이어서 다른 음향기기도 똑같이 재생의 의미로 사용되는 것처럼 일관적인 디자인을 유지한다면 사용자가 예측가능하게 된다.



##### 일관된 데이터 디자인하기

- 데이터는 API의 핵심이다.
- 일관적인 이름을 짓는다.
  - 계좌번호(accountNumber)라는 필드를 어디서는 number, 어디서는 source 이렇게 사용하면 일관적이지 않다.
- 일관성이 있는 데이터 타입과 포맷을 사용한다.
  - 계좌번호를 00012345로 사용했으면 다른 모든 API에서도 똑같은 포맷으로 맞춰야 한다.
  - Timestamp를 쓸거면 Timestamp ISO를 쓸거면 ISO를 쓰자
- api path에서도 일관된 URL 구조를 가져야함
  - /accounts/{accountNumber} O
  - /transefers/delays/{transferId} X -> delays를 붙이지 말장.



##### 일관적인 목표 디자인하기

- API의 동작은 목표에 따라 결정된다.
- 데이터는 일관적이어야함
- 성공, 실패 피드백또한 일관적이어야한다.
  - 어떠한 시도가 200을 리턴했다면 다른 목표는 다른 상태코드를 리턴하도록한다.



##### 일관성의 4단계

1. API 내부에 일관성이 존재
   - 데이터와 목표, 행동등이 일관성이 존재
2. 팀 API 회사 조직 간의 일관성이 존재
   - 조직내의 API간에도 공통 기능(데이터 조직화, 데이터 타입, 포맷)을 공유해야한다.
3. 도메인 간의 API 일관성이 존재
   - 해군의 내비게이션에서는 해리, 육군은 킬로미터 등 도메인에 맞게 데이터를 통일
4. 외부 세계와 일관성이 존재.
   - 일반적인 관행 즉 표준을 따른다.



##### 타인을 따라하자

- 이미 여러가지 관행들과 표준들이 정착되어져 있기 때문에 표준을 따르자.
- DELETE, POST, PUT 등도 REST에서의 기능 표준이므로 그 의미를 쉽게 알 수 있다.



### 적응 가능하게 하기

- 같은 개념에 대하여 다르게 표현하거나 대상에 맞추어 표현을 바꾸는 적응 가능한 API를 디자인하자.



##### 다른포맷으로 제공하기

- 데이터의 포맷은 JSON이 유일하지 않다.
- CSV 포맷으로 표현할 수 있고 PDF 파일로도 표현할 수 있다.
- 이러한 포맷들에 대해 프로바이더에게 요청하고 컨슈머는 원하는 포맷을 받을 수 있다.
  - GET /accounts/{accountId}/transactions?format=CSV
- 아니면 Header정보를 제공해 Accpet: application/json과 같이 요청할 수 있음.
- 제공하지 않는 포맷은 406에러 등을 리턴하자.



##### 국제화와 현지화

- 같은 API에 대해서 다른 여러 국가에 서비스 할 수 있다.
- 이러한 리턴값에 대해 알맞는 언어로 표시해줄 수 있어야 한다.
- language라는 parameter를 넘겨주거나 Accept-Language 헤더를 포함시켜 요청하여 받을 수 있다.



##### 필터, 페이지 정렬 적용하기

- 데이터는 수천개 수만개가 있을 수 있다.
- 이를 한번에 보여줄 수 없으므로 적응가능할 수 있도록 파라미터나 헤더를 통해 페이징을 해서 데이터를 내려준다.



### 탐색 가능하게 하기

- 책을 읽다가 몇페이지인지 알고싶다면 페이지의 숫자를 보면 된다.
- 책의 목차나 페이지가 있다면 페이지 정보를 찾기가 쉬워진다. 이는 독자의 경험을 비약적으로 향상
- API도 책처럼 탐색할 수 있게 디자인 할 수 있다.



##### 메타데이터 제공하기

- 페이징을 통해 데이터를 제공할 때 전체 페이지수랑 아이템 갯수를 모른다면.?
- 이를 위해 API 리턴값에 pagination 데이터를 통해 page와 totalpage수를 제공해줄 수 있다.
- 이렇게 미리 데이터에 대한 정보를 제공해주는 데이터를 메타데이터라 한다.



##### 하이퍼미디어 API 만들기

- API 데이터 또한 데이터간의 하이퍼링크를 제공하여 데이터에 대한 연결점을 제공해줄 수 있다.
- accounts를 조회하는 api의 item들에 href 속성필드를 제공해주어 각 계좌의 detail을 표시해줄 수 있다.
- 이를 통해서 컨슈머는 필요한 API를 쉽게 탐색 가능



##### HTTP 프로토콜의 장점 이용하기

- OPTIONS 메소드를 통해 해당 API가 제공하는 Method 정보를 알 수 있다.

