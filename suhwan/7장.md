# 간결하고 체계적인 API 디자인하기



### API 구조화

- 리모컨을 예로들면 리모컨의 버튼이 제각각으로 배치되어 있으면 사용성이 저하됨.
- 적절히 배치되고 정렬되어야 사용자가 사용하기 편하며 API도 마찬가지로 API의 구조가 잘짜여져 있어야 직관적이고 사용하기 편하다.



#### 데이터 구조화하기



##### 그룹화

- 구조화된 API를 디자인 하는 첫 단계는 데이터이다.
- overdraftProtection 과 limit이라는 필드가 있을 때 전자는 초과 인출 방지의 활성화 여부를 의미하고 limit은 초과 인출의 한도를 말한다.
- 두 필드가 묶여져 있지 않고 제멋대로 배치되어 있으면 두 필드의 관계를 알기 힘들다.
- 약간의 변화를 통해 관계를 묶어 하위 구조로 만들어 낼 수 있다.

##### 정렬

- 데이터가 많으면 가장 중요한 데이터를 식별하는데 어려움이 있음.
- 중요한 순에서 덜 중요한 순으로 데이터를 정렬해주면 좋다.



#### 피드백 구조화하기

- 구조화가 잘 된 API는 피드백도 구조화가 잘 되어 있다.
- HTTP 상태 코드를 이용해서 유용한 피드백을 제공할 수 있다.
- 2XX는 정상적인 요청, 4XX는 잘못된 요청이라는 범주로 상태코드가 카테고라이징 되어 있기 때문에 알기 쉽다.
- 피드백은 상태코드에만 국한되지 않고 에러 반환이나 타입들을 정의해서 더욱 세부적으로 커스터마이징할 수 있다.
  - 에러는 여러가지 에러를 반환해주고 중요한 순에서 중요하지 않은 순으로 정렬해서 반환해준다.



#### 목표 구조화하기

- 목표도 구조화할 수 있다.
- 어떠한 API의 기능적 목표를 그룹화할 수 있다. 예를들어 Transfer라는 목표를 기준으로 송금내역 확인, 송금하기, 송금내역 가져오기 등의 API를 카테고리화 할 수 있다.
- 이들은 tags를 달아 API Spec을 정의하여 기술하는데 도움이 되는듯.





### API 사이징

- 어떠한 물건이 많은 기능을 가지는 것은 좋지만 너무 많은 기능을 가지고 있으면 그 본질적인 목적이 사라져버림.
- 화장실 안에 면도날, 쉐이빙 폼, 칫솔, 치약 다양한 것들이 들어가있으면 화장실이라는 본래의 목적이 희석된다.



#### 데이터 세분화 선택하기

- 은행계좌에 대한 표현을 나타내는 API가 있을 때 표현하는 것들이 너무 많으면 속성의 깊이가 너무 깊어진다.
- 어떠한 데이터를 한번에 보여주기 보단 기능적 관점으로 데이터를 세분화하는 것이 중요하다. (얼마나 많이 제공하는지는 중요하지 않다.)



#### 목표 세분화 선택하기

- 은행계좌에 이체내역이 표시되는 것이 좋나 ?? NO
- **계좌를 가져오는 목표**에 이체목록까지 반환하면 너무 많은 데이터를 표시해주어야한다.
- 또한 페이징의 문제까지 생길 것이기 때문에 매우 복잡해질 것이다.
- 어떤 계좌를 가진 사람의 주소를 변경하려고 할때 계좌에 주소내역이 포함되어 있다면 이 계좌에서 데이터를 찾아 주소를 변경하는 것은 매우 직관적이지 않고 비효율적이다.
- 사람이 여러개의 계좌를 가지고 있을 수도 있으므로 주소 데이터는 분리하는 편이 좋다.
- 계좌를 보여주는 목표에는 계좌에 필요한 정보만 보여주도록하자.



#### API 세분화 선택하기

- 목표를 구조화 하면서 목표간의 경계를 식별하였다.
- Account / Transfer라는 카테고리로 목표를 나누고 거기에 따른 API들을 분류하였다.
- 단순히 카테고리 뿐 아니라 여기서는 API들을 더욱 세분화하여 관리할 수 있다. Transfer는 송금 과정에 필요한 목표, 받는 계좌를 관리하는 목표로 세부적으로 목표를 나누어 그룹화 할 수 있다. 
- 이렇게 유용하고 독립적인 단위로 나눌 수 있으면 API의 목표를 좀더 쉽게 알 수 있고 명확하게 알 수 있다..





