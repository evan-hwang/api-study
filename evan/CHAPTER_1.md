# 1부. API 디자인 기초

1부에서는 다음을 다룬다.

- API가 무엇인가?
- API를 개발 전에 디자인해야 하는 이유
- API를 배우는 본질적 의미



프로그래밍 영역에 들어가기 전, API를 ==사용자 관점에서 고려해야한다는 점==을 알게된다.

API는 제공하는 시스템이 아니라 사용자들이 목표르 쉽게 달성하도록 도와야한다.

사용자들이 원하는 목표를 파악하고 정확하게 묘사해야 REST API와 같은 실제 인터페이스를 디자인 가능하다.



## 1. API 디자인이란 무엇인가?

*웹 어플리케이션이 아니더라도 우리 세상은 모두 인터페이스를 통해서 커뮤니케이션한다.*

*어플리케이션은 API 시스템의 품질이 성공과 실패를 좌우하기도 한다.*



### 1.1 API란 무엇인가?

#### 1.1.1 소프트웨어를 위한 웹 인터페이스

*소프트웨어들은 웹 위에서 프로토콜이 적용된 API를 이용해 소통한다.*



웹 API, 즉 소프트웨어를 위한 웹 인터페이스를 말한다. 

> ✏️ 인터페이스
>
> 두 개의 시스템, 대상, 조직 또는 그 밖의 대상들이 만나고 **상호작용하는 지점**

모바일 앱에서 UI(User **Interface**)를 통해서 사용자와 앱이 상호 작용하듯 애플리케이션이 다른 애플리케이션과 소통하려면 프로그래밍 인터페이스가 필요하다.

단순히, API는 소프트웨어가 제공하는 인터페이스인 것이다. 소프트웨어의 내부 실제 구현을 추상화함으로서 사용자에게 편의를 제공한다.



**컨슈머와 프로바이더**

이 책에서는 컨슈머와 프로바이더 관점을 중요하게 여긴다. 이는 다음의 개념이다.

- 컨슈머 
  - 클라이언트 개발자
  - ex) 컨텐츠를 소비하는 측, 제품 소비자, 식당 고객

- 프로바이더
  - 컨텐츠를 제공하는 측
  - ex) 백엔드 개발자, 제품 개발자, 식당 메뉴판



**HTTP(Hypertext Transfer Protocol)**

클라이언트와 백엔드가 소통하기 위해선 네트워크를 사용한다. 그 소통에는 규약이 있는데 HTTP이다. 이 규약을 지켜 서로 통신하게 된다. 이 책에서 다루는 내용은 위와 같이 프로토콜에 의존하기 때문에 웹 API 불린다.



#### 1.1.2 소프트웨어를 레고처럼 바꾼다

*잘짜여진 API는 소프트웨어를 재사용 가능한 블록으로 만들어주어 손쉽게 조립가능하게 한다.*



**마이크로 서비스에서의 API**

점점 많은 모놀로틱 서비스들이 다음과 같은 이유로 MSA(Micro Service Architecture)로 변경되어간다.

- 가용성 : 서비스가 장애 없이 정상적으로 운영되는 능력
- 응답성 : 어떠한 이벤트에 대하여 즉각적으로 반응할 수 있는 능력
- 확장성 :  이용자의 요청에 따라 자원의 양을 할당할 수 있는 능력
- 신뢰성 : 클라우드서비스를 정상적으로 운영할 수 있는 능력 (서비스 회복)
- 서비스 지속성 : 클라우드서비스를 안정적으로 계속하여 제공할 수 있는 능력
- ...

이 서비스들은 서로 API를 통해 호출하게되는데, 잘 짜여진 웹 API 는 구멍에 잘 맞는 레고 블럭처럼 각 서비스들이 원할하게 소통할 수 있도록 해준다.



**서드파티에서의 API**

서드파티 제공자들은 약관에 충실하면 누구나 퍼블릭 API를 사용하도록 제공한다. 이전의 회사들은 모든 기능을 내부에서 개발했지만, 각각의 핵심 소프트웨어에 역량을 위임하면서 더 나은 서비스들이 쉽게 개발될 수 있어졌다.

- ex) 얼굴 인식 서비스, 대용량 데이터 처리 서비스...



### 1.2 API 디자인이 중요한 이유

*소프트웨어를 만들고 사용하는 주체는 사람이다.*



적절하게 디자인된 다른 인터페이스(전자제품 버튼, 식당의 메뉴판)처럼 소프트웨어도 사람이 사용하는 것이다. 가량 현관문을 열때 내부 경첩을 직접 조작해야하거나, TV +/-를 누를 때 채널이 바뀐다면 해당 제품은 소비되지 않을 것이다.



#### 1.2.1 퍼블릭, 프라이빗 API는 다른 개발자들도 사용한다

*개발자들은 이전에 상호작용을 경험한 다른 인터페이스처럼 API도 유용하고 단순하기를 기대한다.*

언제든 퍼블릭 API가 새로운 개발자들에게 제공될 수 있다.

- 오픈소스로 서비스를 외부 개발자들에게 공개한다.
- 다른 회사에 우리 서비스를 제공한다.
- 내부에 새로운 개발자가 입사한다.

이 때에도 유용하고 단순하기를 기대하는 개발자들을 충족시켜야한다.

> ✏️ 개발자 경험 (Developer experience)
>
> API의 DX란 API를 사용하는 개발자들의 경험을 의미한다. 이 API를 사용하는 방법에 대한 문서화와 문제에 처했을 때 돕는 기술 지원들을 말한다. DX 중에서도 API는 **매우 중요**하다. 



#### 1.2.2 API는 구현을 숨겨준다

*사용자가 내부 구현을 알 필요 없이 비지니스 로직을 처리하게 해준다.*



API가 내부 구현을 숨겨준다는 것에 대해 식당을 찾아간 고객의 예를 통해 설명해보겠다.

- **인터페이스를 사용하는 예**
  1. 고객이 식당에 입장한다.
  2. 웨이터에게 말을 건다.
  3. **메뉴판(식당의 인터페이스)**를 사용하여 스테이크를 미디움으로 주문한다.
  4. 음식을 전달 받는다.
- **인터페이스가 없는 예**
  1. 고객이 식당에 입장한다.
  2. 스테이크를 15분간 180도에서 앞뒤로 뒤집고 소스와 야채를 포함해서 달라고 한다.
  3. 음식을 전달 받는다.

인터페이스가 있으면 우리는 음식이 어떻게 조리되는지 알 필요 없이 식당에서 제공하는 스테이크의 형태를 메뉴판을 통해 웨이터에게만 주문하면 된다.



이와 마찬가지로 개발자들은 어떤 서비스를 가져다 쓸 때 해당 서비스가 Go나 Java 언어로 작성됐는지 NodeJS나 파이썬으로 만들어졌는지 전혀 알 필요 없이 API 문서만을 가지고 비지니스 로직을 처리하면 되는 것이다.



#### 1.2.3 API를 어설프게 디자인하면 끔찍한 결과가 이어진다

*형편 없는 버튼을 제공하는 제품은 팔리지 않는다.*



어떻게 동작할지 알 수 없는 버튼들이 덕지 덕지 달린 제품이 안 팔리는 것처럼, 형편 없이 디자인 된 API를 가진 소프트웨어는 사용되지 않는다. 

사람들은 API의 인터페이스와 문서를 통해 API를 판별한다. 아무리 빼어난 문서를 제공해도 사용하기 어렵거나 위험하게 하는 디자인 결함을 숨길수는 없다. **고객들은 이러한 제품을 선택하지 않고 수익도 없을 것이다. 이는 회사를 파산으로 몰고간다.**



### 1.3 API 디자인에 필요한 요소

*커스터머 측면과 프로바이더 측면을 고려하여 디자인하라*



#### 1.3.1 프로그래밍 인터페이스 이상의 디자인 원리 이해

*API의 목적은 사람들에게 이루고자 하는 바를 가급적 단순하게 이루게 해주는 데 있다.*

API 스타일에는 다음이 있다.

- RPC
- SOAP
- REST
- gRPC
- GraphQL
- ...

이러한 스타일을 쓰더라도 API에 대한 포괄적 이해가 없다면 일반적이지 않은 유즈케이스나 잘 다루지 않는 컨텍스트를 마추쳤을 때 오랫동안 고생할 것이다. 그러니까 스타일도 중요하지만 포괄적 이해부터하자.



#### 1.3.2 API 디자인의 모든 측면

*품질이 어떻든 사람들에게 인터페이스를 공개한 후에 바꾸는 것은 굉장히 많은 주의를 요한다.*

API 디자인 고려 사항

- 안전한 인터페이스를 설계해야한다.
  - 민감한 데이터나 동작을 컨슈머에게 과도하게 노출하지 않는다.
- 누가 쓸 것인지 식별한다.
- 어떻게 API가 만들어지고 발전될지 계획한다.
- 조직에서 만들어낸 API는 모두 유사한 모양과 느낌이 들도록해 API가 이해하기 쉽고 사용하기 쉽게 만든다.